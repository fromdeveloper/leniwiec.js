/*!
 * @package Leniwiec.js
 * @version v2.0.0
 * @author Przemysław Tyczyński | https://tyczynski.pl
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Leniwiec=t()}(this,function(){"use strict";const e={root:null,rootMargin:"0px",threshold:0,errorClassName:"is-error",loadedClassName:"is-loaded",onLoad:null,onError:null};return class{constructor(t,s={}){this.elements=Array.from(t),this.config=Object.assign({},e,s),this.observer=this.createObserver(),("undefined"!=typeof window&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent))&&this.loadAll()}createObserver(){const{root:e,rootMargin:t,threshold:s}=this.config,r=new IntersectionObserver(this.callback.bind(this),{root:e,rootMargin:t,threshold:s});for(let e of this.elements)r.observe(e);return r}callback(e){e.forEach(e=>{const{target:t}=e;e.isIntersecting&&this.loadAndUnobserve(t)})}loadAndUnobserve(e){this.load(e),this.observer.unobserve(e)}load(e){const t=this.getTargetAttributes(e);let s=[];e.hasAttribute("data-load-image")&&(s=[t.src]),e.hasAttribute("data-load-image")||"IMG"===e.tagName?this.setImg(e,t,s):"PICTURE"===e.tagName?this.setPicture(e,t):this.setBackgroundImage(e,t)}setImg(e,t,s){const{src:r}=t,o=document.createElement("image");this.bindTargetCallbacks(o,o,s),e.setAttribute("src",r)}setBackgroundImage(e,t){const{src:s}=t,r=document.createElement("image");this.bindTargetCallbacks(r,e),r.setAttribute("src",s),e.style.backgroundImage=`url(${s})`}setPicture(e,t){const{src:s,alt:r}=t,o=document.createElement("image");this.bindTargetCallbacks(o,e),o.setAttribute("src",s),o.setAttribute("alt",r),e.appendChild(o)}getTargetAttributes(e){const t=e.dataset.src||e.dataset.backgroundImage||e.dataset.image||"",{alt:s=""}=e.dataset;return{src:t,alt:s}}bindTargetCallbacks(e,t,s=[]){const{loadedClassName:r,errorClassName:o}=this.config;e.addEventListener("load",()=>{t.classList.add(r),this.config.onLoad(t,...s)}),e.addEventListener("error",()=>{t.classList.add(o),this.config.onError(t,...s)})}loadAll(){for(let e of this.elements)this.loadAndUnobserve(e)}observe(e){this.observer.observe(e)}unmount(){this.observer.disconnect()}}});
