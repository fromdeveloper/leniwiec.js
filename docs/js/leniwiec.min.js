/**
 * @package leniwiec - A lightweight library for lazy loading of images based on the IntersectionObserver API.
 * @version v1.1.0
 * @link https://github.com/tyczynski/leniwiec.js
 * @author Przemysław Tyczyński | https://tyczynski.pl
 * @license MIT
 */
function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Leniwiec=t()}(this,function(){"use strict";var e={root:null,rootMargin:"0px",threshold:0,errorClassName:"is-error",loadedClassName:"is-loaded",onLoad:function(){},onError:function(){}};return function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".leniwiec",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.elements=document.querySelectorAll(n),this.config=_extends({},e,r),this.observer=null}return _createClass(t,[{key:"mount",value:function(){this.observer=new IntersectionObserver(this.callback.bind(this),{root:this.config.root,rootMargin:this.config.rootMargin,threshold:this.config.threshold});for(var e=0;e<this.elements.length;e+=1)this.observer.observe(this.elements[e]);("undefined"!=typeof window&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent))&&this.loadAll()}},{key:"unmount",value:function(){for(var e=0;e<this.elements.length;e+=1)this.observer.unobserve(this.elements[e])}},{key:"callback",value:function(e){var t=this;e.forEach(function(e){var n=e.target;e.isIntersecting&&t.loadAndUnobserve(n)})}},{key:"load",value:function(e){if(e.dataset.loadImage)this.onlyLoad(e);else switch(e.tagName){case"IMG":this.setSrc(e);break;case"PICTURE":this.setPicture(e);break;default:this.setBackground(e)}}},{key:"onlyLoad",value:function(e){var n=t.getTargetAttributes(e).src,r=new Image;this.bindImageEvents(r,e,[n]),r.setAttribute("src",n)}},{key:"setSrc",value:function(e){var n=t.getTargetAttributes(e).src;this.bindImageEvents(e,e),e.setAttribute("src",n)}},{key:"setBackground",value:function(e){var n=t.getTargetAttributes(e).src,r=new Image;this.bindImageEvents(r,e),r.setAttribute("src",n),e.style.backgroundImage="url(".concat(n,")")}},{key:"setPicture",value:function(e){var n=t.getTargetAttributes(e),r=n.src,o=n.alt,a=new Image;this.bindImageEvents(a,e),a.setAttribute("src",r),a.setAttribute("alt",o),e.appendChild(a)}},{key:"bindImageEvents",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=this.config,a=o.loadedClassName,i=o.errorClassName;e.addEventListener("load",function(){var e;t.classList.add(a),(e=n.config).onLoad.apply(e,[t].concat(_toConsumableArray(r)))}),e.addEventListener("error",function(){var e;t.classList.add(i),(e=n.config).onError.apply(e,[t].concat(_toConsumableArray(r)))})}},{key:"loadAllAndUnmount",value:function(){for(var e=0;e<this.elements.length;e+=1)this.loadAndUnobserve(this.elements[e])}},{key:"loadAndUnobserve",value:function(e){this.load(e),this.observer.unobserve(e)}},{key:"observe",value:function(e){this.observer.observe(e)}}],[{key:"getTargetAttributes",value:function(e){return{src:e.dataset.src||e.dataset.backgroundImage||e.dataset.loadImage||"",alt:e.dataset.alt||""}}}]),t}()});